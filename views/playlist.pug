extends layout

block main
  if(playlistTotal === 0) 
    if (user !== undefined)
      a(href=`/${playlistType}/playlists/${page}/playlist/${pagePl}/${playlistId}/contributors/1`) Contributors
    if(playlistType === "your")
      a(href=`/${playlistType}/playlists/${page}/playlist/${pagePl}/${playlistId}/contributors/add`) Add 
    p(class="errorTxt") There are currently no songs on the playlist.
    if(playlistTotal === 0 && (playlistType === "your" || playlistType === "contribution")) 
      p(class="errorTxt") Add a song below.
      .errorMessages
        - let msgTypes = Object.keys(flash || {})
        if (msgTypes.length > 0) 
          each msgType in msgTypes
            each msg in flash[msgType]
              pre(class=`${msgType}`) #{msg}
      if (!(playlistType === "anonPublic"))
        a(href=`/${playlistType}/playlists/${page}`) Back
      else
        a(href=`/anon/public/playlists/${page}`) Back
      .playlistsDiv
        .addDiv
          form(class="addForm" action=`/${playlistType}/playlists/${page}/playlist/${pagePl}/${playlistId}/add` method="post")
            .verticalDiv
              .songInputDiv
                input(class="inputURL" id="url" type="text" name="url" placeholder="Youtube URL" value=url) 
                input(class="inputURL" id="title" type="text" name="title" placeholder="Video Title" value=title) 
            input(class="addBtn" type="submit" value="Add")
  else 
    .playlistsDiv
      h1(class="pageTitle") #{pageTitle}
      block listWrap 
        block list 
          .listHeader
            .headerLeft
              - let songLabel = playlist.songTotal < 2 ? "Song" : "Songs"
              p(class="username") #{playlist.songTotal} #{songLabel}
            if (user !== undefined)
              a(href=`/${playlistType}/playlists/${page}/playlist/${pagePl}/${playlistId}/contributors/1`) Contributors
            if(playlistType === "your")
              a(href=`/${playlistType}/playlists/${page}/playlist/${pagePl}/${playlistId}/contributors/add`) Add 
          - console.log({flash});
          if (Object.keys(flash).length > 0)
            .errorMessages
              - let msgTypes = Object.keys(flash || {})
              if (msgTypes.length > 0) 
                each msgType in msgTypes
                  each msg in flash[msgType]
                    pre(class=`${msgType}`) #{msg}
          if (!(playlistType === "anonPublic"))
            a(href=`/${playlistType}/playlists/${page}`) Back
          else
            a(href=`/anon/public/playlists/${page}`) Back
          .iframeDiv
            #player
          .currentSong
            .playIcon
              p ♫
            .valNo
              p(id="curSongNo") ...
            .valTitle
              p(id="curSongTitle") ...
            .valAddedBy
              p(id="curAddedBy") ...
          if (playlistType !== "public" && playlistType !== "anonPublic")
            .addDiv
              form(class="addForm" action=`/${playlistType}/playlists/${page}/playlist/${pagePl}/${playlistId}/add` method="post")
                .verticalDiv
                  .songInputDiv
                    input(class="inputURL" id="url" type="text" name="url" placeholder="Youtube URL" value=url) 
                    input(class="inputURL" id="title" type="text" name="title" placeholder="Video Title" value=title) 
                input(class="addBtn" type="submit" value="Add")
          .pageNav 
            if (pagePl > 1) 
              if (playlistType !== "anonPublic")
                a(href=`/${playlistType}/playlists/${page}/playlist/${pagePl - 1}/${playlistId}`) ⮜
              else 
                a(href=`/anon/public/playlists/${page}/playlist/${pagePl - 1}/${playlistId}`) ⮜
            .pages
              - for (let pageNum  = startPage ; pageNum <= endPage; pageNum++)
                if (playlistType !== "anonPublic")
                  a(class=`${(pageNum === pagePl) ? "curPage" : ""}` href=`/${playlistType}/playlists/${page}/playlist/${pageNum}/${playlistId}`) #{pageNum}
                else 
                  a(class=`${(pageNum === pagePl) ? "curPage" : ""}` href=`/anon/public/playlists/${page}/playlist/${pageNum}/${playlistId}`) #{pageNum}
            if (pagePl < totalPages) 
              if (playlistType !== "anonPublic")
                a(href=`/${playlistType}/playlists/${page}/playlist/${pagePl + 1}/${playlistId}`)
                  img(src=`/assets/icons/arrow.svg`)
              else 
                a(href=`/anon/public/playlists/${page}/playlist/${pagePl + 1}/${playlistId}`)
                  img(src=`/assets/icons/arrow.svg` class="rotate180")
        block values
          .content
            .playListWrap
              each song in playlist.songs
                div(class="songCard" data-video-id=`${song.video_id}`)
                 .descriptionDiv
                    .valNo
                      p= playlist.songs.indexOf(song) + 1
                    .valTitle
                      p= song.title   
                    .valAddedBy
                      p= song.added_by
                    if (user !== undefined && playlistType !== "public")
                      div(class="songBtns")
                        .valEdit
                          form(class="delete" action=`/${playlistType}/playlists/${page}/playlist/${pagePl}/${playlistId}/${song.id}/edit` method="get")
                            input(class="editBtn" type="submit" value="")
                        .valDelete
                          if (user !== undefined)
                            form(class="delete" action=`/${playlistType}/playlists/${page}/playlist/${pagePl}/${playlistId}/${song.id}/delete` method="post")
                              input(onclick = "confirmSubmit(event,'Do you want to delete the song from the playlist?')" class="deleteBtn" type="submit" value="")

